<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Time Bar with Local and New York Market Times</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            margin: 20px;
        }

        .bar-container {
            position: relative;
            width: 100%;
            max-width: 800px;
            height: 50px;
            background-color: lightgray;
            margin: 20px auto;
            border: 1px solid black;
        }

        .time-bar-marker {
            position: absolute;
            height: 100%;
            width: 2px;
        }

        .current-time {
            background-color: red;
        }

        .market-time {
            background-color: green;
        }

        .label {
            position: absolute;
            top: -25px;
            transform: translateX(-50%);
            font-size: 12px;
        }

        #current-time-label {
            color: red;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <h1>Local Time & New York Market Hours</h1>
    <div class="bar-container" id="time-bar">
        <!-- Labels dynamically added by JavaScript -->
    </div>
    <p id="local-time">Loading your local time...</p>
    <p id="market-hours">Loading New York market hours...</p>

    <script>
        const timeBar = document.getElementById('time-bar');
        const localTimeDisplay = document.getElementById('local-time');
        const marketHoursDisplay = document.getElementById('market-hours');

        const totalHours = 24; // Total hours in a day
        const nyMarketStart = 9.5; // New York market starts at 9:30 AM
        const nyMarketEnd = 16; // New York market ends at 4:00 PM

        // Helper function to format time
        function formatTime(hours) {
            const date = new Date();
            date.setHours(Math.floor(hours), (hours % 1) * 60, 0, 0);
            return date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit', hour12: true });
        }

        function updateTimeBar() {
            const now = new Date();

            // Get local timezone offset and New York timezone offset
            const localOffset = now.getTimezoneOffset() / 60; // Offset from UTC
            const nyOffset = -5; // Standard New York offset from UTC
            const nyIsDST = new Date().toLocaleString("en-US", { timeZone: "America/New_York", timeZoneName: "short" }).includes("EDT");
            const nyCurrentOffset = nyOffset + (nyIsDST ? 1 : 0); // Adjust for daylight savings

            // Calculate New York market hours in local time
            const localMarketStart = nyMarketStart + nyCurrentOffset - localOffset;
            const localMarketEnd = nyMarketEnd + nyCurrentOffset - localOffset;

            // Clear previous markers
            timeBar.innerHTML = '';

            // Add the market open marker
            const marketOpenMarker = document.createElement('div');
            marketOpenMarker.className = 'time-bar-marker market-time';
            marketOpenMarker.style.left = `${(localMarketStart / totalHours) * 100}%`;
            timeBar.appendChild(marketOpenMarker);

            const marketOpenLabel = document.createElement('div');
            marketOpenLabel.className = 'label';
            marketOpenLabel.innerText = `Open: ${formatTime(localMarketStart)}`;
            marketOpenLabel.style.left = `${(localMarketStart / totalHours) * 100}%`;
            timeBar.appendChild(marketOpenLabel);

            // Add the market close marker
            const marketCloseMarker = document.createElement('div');
            marketCloseMarker.className = 'time-bar-marker market-time';
            marketCloseMarker.style.left = `${(localMarketEnd / totalHours) * 100}%`;
            timeBar.appendChild(marketCloseMarker);

            const marketCloseLabel = document.createElement('div');
            marketCloseLabel.className = 'label';
            marketCloseLabel.innerText = `Close: ${formatTime(localMarketEnd)}`;
            marketCloseLabel.style.left = `${(localMarketEnd / totalHours) * 100}%`;
            timeBar.appendChild(marketCloseLabel);

            // Add the current time marker
            const currentHour = now.getHours() + now.getMinutes() / 60;
            const currentTimeMarker = document.createElement('div');
            currentTimeMarker.className = 'time-bar-marker current-time';
            currentTimeMarker.style.left = `${(currentHour / totalHours) * 100}%`;
            timeBar.appendChild(currentTimeMarker);

            const currentTimeLabel = document.createElement('div');
            currentTimeLabel.className = 'label';
            currentTimeLabel.id = 'current-time-label';
            currentTimeLabel.innerText = `Now: ${formatTime(currentHour)}`;
            currentTimeLabel.style.left = `${(currentHour / totalHours) * 100}%`;
            timeBar.appendChild(currentTimeLabel);

            // Update the displayed time and market hours
            localTimeDisplay.textContent = `Your Local Time: ${now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: true })}`;
            marketHoursDisplay.textContent = `New York Market Hours in Your Local Time: ${formatTime(localMarketStart)} - ${formatTime(localMarketEnd)}`;
        }

        // Update the time bar every second
        updateTimeBar();
        setInterval(updateTimeBar, 1000);
    </script>
</body>
</html>
