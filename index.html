<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>New York Market Hours</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            margin: 20px;
        }
        .bar-container {
            position: relative;
            width: 100%;
            max-width: 800px;
            height: 50px;
            background-color: lightgray;
            margin: 20px auto;
            border: 1px solid black;
        }
        .time-bar-marker {
            position: absolute;
            height: 100%;
            width: 2px;
        }
        .current-time {
            background-color: red;
        }
        .market-time {
            background-color: green;
        }
        .label {
            position: absolute;
            top: -25px;
            transform: translateX(-50%);
            font-size: 12px;
        }
        #current-time-label {
            color: red;
            font-weight: bold;
            top: 55px;
        }
    </style>
</head>
<body>
    <h1>Local Time & New York Market Hours</h1>
    <div class="bar-container" id="time-bar">
        <!-- Labels dynamically added by JavaScript -->
    </div>
    <p id="local-time">Loading your local time...</p>
    <p id="market-hours">Loading New York market hours...</p>

    <div class="current-time-container">
        <p id="current-time-label">Your Local Time: Loading...</p>
    </div>

    <script>
        const timeBar = document.getElementById('time-bar');
        const localTimeDisplay = document.getElementById('local-time');
        const marketHoursDisplay = document.getElementById('market-hours');
        const currentTimeLabel = document.getElementById('current-time-label');

        const totalHours = 24; // Total hours in a day
        const nyMarketStart = 9.5; // New York market starts at 9:30 AM (9.5 hours)
        const nyMarketEnd = 16; // New York market ends at 4:00 PM

        // Helper function to format time in 24-hour format
        function formatTime24hr(hours) {
            const date = new Date();
            date.setHours(Math.floor(hours), (hours % 1) * 60, 0, 0);
            return date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit', hour12: false });
        }

        // Function to convert New York market hours to local time
        function convertMarketHoursToLocal() {
            const now = new Date();

            // Get local time zone offset in hours
            const localOffset = now.getTimezoneOffset() / 60;

            // New York time zone offsets: UTC-5 for EST, UTC-4 for EDT
            const nyOffset = -5; // Base offset for EST (without daylight saving)
            const nyIsDST = new Date().toLocaleString("en-US", { timeZone: "America/New_York", timeZoneName: "short" }).includes("EDT");
            const nyCurrentOffset = nyOffset + (nyIsDST ? 1 : 0); // Adjust for daylight savings

            // Calculate New York market open and close in local time
            const localMarketStart = nyMarketStart + nyCurrentOffset - localOffset;
            const localMarketEnd = nyMarketEnd + nyCurrentOffset - localOffset;

            // Adjust for crossing midnight (if applicable)
            if (localMarketStart >= 24) localMarketStart -= 24;
            if (localMarketEnd >= 24) localMarketEnd -= 24;

            // Update the time bar markers and labels
            timeBar.innerHTML = ''; // Clear previous markers

            // Add market open marker
            const marketOpenMarker = document.createElement('div');
            marketOpenMarker.className = 'time-bar-marker market-time';
            marketOpenMarker.style.left = `${(localMarketStart / totalHours) * 100}%`;
            timeBar.appendChild(marketOpenMarker);

            const marketOpenLabel = document.createElement('div');
            marketOpenLabel.className = 'label';
            marketOpenLabel.innerText = `Open: ${formatTime24hr(localMarketStart)}`;
            marketOpenLabel.style.left = `${(localMarketStart / totalHours) * 100}%`;
            timeBar.appendChild(marketOpenLabel);

            // Add market close marker
            const marketCloseMarker = document.createElement('div');
            marketCloseMarker.className = 'time-bar-marker market-time';
            marketCloseMarker.style.left = `${(localMarketEnd / totalHours) * 100}%`;
            timeBar.appendChild(marketCloseMarker);

            const marketCloseLabel = document.createElement('div');
            marketCloseLabel.className = 'label';
            marketCloseLabel.innerText = `Close: ${formatTime24hr(localMarketEnd)}`;
            marketCloseLabel.style.left = `${(localMarketEnd / totalHours) * 100}%`;
            timeBar.appendChild(marketCloseLabel);

            // Add current time marker
            const currentHour = now.getHours() + now.getMinutes() / 60;
            const currentTimeMarker = document.createElement('div');
            currentTimeMarker.className = 'time-bar-marker current-time';
            currentTimeMarker.style.left = `${(currentHour / totalHours) * 100}%`;
            timeBar.appendChild(currentTimeMarker);

            // Update displayed times
            localTimeDisplay.textContent = `Your Local Time: ${now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: false })}`;
            marketHoursDisplay.textContent = `New York Market Hours in Your Local Time: ${formatTime24hr(localMarketStart)} - ${formatTime24hr(localMarketEnd)}`;
            currentTimeLabel.textContent = `Your Local Time: ${now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit', hour12: false })}`;
        }

        // Update the time bar every second
        convertMarketHoursToLocal();
        setInterval(convertMarketHoursToLocal, 1000);
    </script>
</body>
</html>
