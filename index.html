<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Market Hours Visual</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            margin: 20px;
        }

        .bar-container {
            width: 600px;
            height: 50px;
            background-color: lightgray;
            margin: 20px auto;
            position: relative;
        }

        .market-bar {
            position: absolute;
            height: 100%;
            background-color: green;
        }

        .vertical-line {
            position: absolute;
            width: 2px;
            height: 100px;
            background-color: black;
            top: -25px;
        }

        .current-time-line {
            position: absolute;
            width: 2px;
            height: 100px;
            background-color: red;
            top: -25px;
        }

        .market-label {
            position: absolute;
            top: -60px;
            font-size: 16px;
            font-weight: bold;
            transform: translateX(-50%);
            line-height: 1.5;
            text-align: center;
        }
    </style>
</head>
<body>
    <h1>New York Market Hours</h1>
    <div class="bar-container">
        <!-- Market bar -->
        <div class="market-bar"></div>
        <!-- Vertical line at market open -->
        <div class="vertical-line" style="left: 0%;"></div>
        <!-- Vertical line at market close -->
        <div class="vertical-line" style="left: 100%;"></div>
        <!-- Current time line -->
        <div class="current-time-line" style="left: 0%;"></div>
        <!-- Market label -->
        <div class="market-label" id="market-label">Loading...</div>
    </div>
    <p id="local-time"></p>

    <script>
        const totalHours = 24; // Total hours in a day

        // New York market hours in New York local time
        const nyMarketStartHour = 9.5; // 9:30 AM (decimal format)
        const nyMarketEndHour = 16; // 4:00 PM (decimal format)

        const barContainer = document.querySelector('.bar-container');
        const marketBar = document.querySelector('.market-bar');
        const verticalLines = document.querySelectorAll('.vertical-line');
        const currentTimeLine = document.querySelector('.current-time-line');
        const marketLabel = document.getElementById('market-label');
        const localTimeDisplay = document.getElementById('local-time');

        // Helper function to format time
        function formatTime(date) {
            return date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit', hour12: true });
        }

        // Function to calculate market hours and update the UI
        function updateMarketHours() {
            const now = new Date();

            // Get local time zone offset in hours
            const localOffset = now.getTimezoneOffset() / 60; // Local offset from UTC
            const nyOffset = -5; // New York offset from UTC (standard time)

            // Adjust for daylight saving time in New York
            const nyIsDST = new Date().toLocaleString("en-US", { timeZone: "America/New_York", timeZoneName: "short" }).includes("EDT");
            const nyCurrentOffset = nyOffset + (nyIsDST ? 1 : 0);

            // Calculate New York market hours in local time
            const localStartHour = nyMarketStartHour + nyCurrentOffset - localOffset;
            const localEndHour = nyMarketEndHour + nyCurrentOffset - localOffset;

            // Update the market bar and labels
            marketBar.style.left = (localStartHour / totalHours) * 100 + '%';
            marketBar.style.width = ((localEndHour - localStartHour) / totalHours) * 100 + '%';
            verticalLines[0].style.left = (localStartHour / totalHours) * 100 + '%';
            verticalLines[1].style.left = (localEndHour / totalHours) * 100 + '%';

            // Display market hours in local time
            const localStartTime = new Date(now.setHours(localStartHour, (localStartHour % 1) * 60, 0, 0));
            const localEndTime = new Date(now.setHours(localEndHour, (localEndHour % 1) * 60, 0, 0));

            marketLabel.innerHTML = `
                New York<br>
                Open: ${formatTime(localStartTime)} | Close: ${formatTime(localEndTime)}
            `;
        }

        // Function to update the current time line dynamically
        function updateCurrentTime() {
            const now = new Date();
            const currentHour = now.getHours() + now.getMinutes() / 60;
            currentTimeLine.style.left = (currentHour / totalHours) * 100 + '%';

            localTimeDisplay.textContent = `Your Local Time: ${now.toLocaleTimeString()}`;
        }

        // Update the market hours and current time every second
        updateMarketHours();
        setInterval(updateCurrentTime, 1000);
    </script>
</body>
</html>
